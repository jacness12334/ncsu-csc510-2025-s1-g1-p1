name: ğŸ¨ Style Checks

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
  workflow_dispatch:

jobs:
  style_checks:
    runs-on: ubuntu-latest
    
    steps:
    - name: â¬‡ï¸ Checkout Repository
      uses: actions/checkout@v4
      with:
        fetch-depth: 0

    # --- 1. Prettier Formatting Check (Markdown, JSON, YAML, etc.) ---
    
    - name: âš™ï¸ Setup Node.js for Prettier
      uses: actions/setup-node@v4
      with:
        node-version: '20'

    - name: ğŸ“¥ Install Prettier
      run: npm install --global prettier

    - name: ğŸ” Prettier Check on Configuration and Documentation
      run: |
        prettier --check .

    # --- 2. YAML Linting (using a direct, reliable method) ---
    # FIX: Replaced the non-resolvable 'ibi/yamllint-action' with a direct pip installation.
    - name: ğŸ Setup Python and Install Yamllint
      # Since yamllint is a Python package, we set up Python for stability.
      uses: actions/setup-python@v5
      with:
        python-version: '3.x'

    - name: ğŸ“œ Run Yamllint Check
      run: |
        pip install yamllint
        # The 'yamllint' command automatically looks for '.yamllint.yaml' in the root.
        # We specify the directories to check, as configuration files are the primary focus.
        yamllint -c .yamllint.yaml .github/workflows/*.yml *.yml *.yaml

    # --- 3. Dockerfile Linting (Hadolint) ---
    - name: ğŸ³ Run Hadolint (Dockerfile Linter)
      # This action is generally stable, but confirm its existence if issues persist.
      uses: reviewdog/action-hadolint@v1
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        dockerfile-path: ./Dockerfile
