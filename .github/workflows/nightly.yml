name: Nightly Workflow Dispatch

# Controls when the workflow will run
on:
  # Triggers the workflow on a schedule using cron syntax (0 0 * * *) 
  # This runs daily at 00:00 UTC (midnight)
  schedule:
    - cron: '0 0 * * *'
  
  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

jobs:
  # Job to dispatch the 'CI' workflow (main.yml)
  dispatch_ci:
    runs-on: ubuntu-latest
    steps:
      - name: Dispatch main.yml (CI)
        uses: actions/github-script@v6
        with:
          script: |
            await github.rest.actions.createWorkflowDispatch({
              owner: context.repo.owner,
              repo: context.repo.repo,
              workflow_id: 'main.yml', # Filename of the workflow to dispatch
              ref: 'main', # Branch to run the workflow on
              # inputs: {} # Add inputs if the dispatched workflow requires them
            })

  # Job to dispatch the 'Lint Code Base' workflow (linter.yml)
  dispatch_linter:
    runs-on: ubuntu-latest
    # Wait for the CI workflow dispatch to complete, though not strictly required
    needs: dispatch_ci 
    steps:
      - name: Dispatch linter.yml (Lint Code Base)
        uses: actions/github-script@v6
        with:
          script: |
            await github.rest.actions.createWorkflowDispatch({
              owner: context.repo.owner,
              repo: context.repo.repo,
              workflow_id: 'linter.yml', # Filename of the workflow to dispatch
              ref: 'main', # Branch to run the workflow on
              # inputs: {} # Add inputs if the dispatched workflow requires them
            })
            await github.rest.actions.createWorkflowDispatch({
              owner: context.repo.owner,
              repo: context.repo.repo,
              workflow_id: 'main.yml', # Filename of the workflow to dispatch
              ref: 'main', # Branch to run the workflow on
              # inputs: {} # Add inputs if the dispatched workflow requires them
            })
